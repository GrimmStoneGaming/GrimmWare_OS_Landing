<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GrimmWare OS Gateway</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* TEMP: Highlight the Run It flicker for debug */
    .run-it-flicker.debug-highlight {
      outline: 2px dashed lime;
      background: rgba(0, 255, 0, 0.05);
    }

    /* TEMP: Debug logger */
    #debug-log {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      max-height: 160px;
      overflow-y: auto;
      font-size: 0.8rem;
      font-family: monospace;
      background: rgba(0, 0, 0, 0.95);
      color: lime;
      border-top: 1px solid lime;
      z-index: 99999;
      padding: 0.5rem;
    }
  </style>
</head>
<body>

  <!-- LANDING PAGE (Already Loaded Behind Gateway) -->
  <div id="landing-page" class="preloaded" aria-hidden="true">
    <div class="lp-content">
      <h1>Welcome to GrimmWare OS</h1>
      <p>This is your system now.</p>
    </div>
  </div>

  <!-- GATEWAY UI -->
  <div id="gateway-ui">
    <div class="top-container">
      <div class="logo-container">
        <img class="logo-main" src="images/grimmware-logo.png" alt="GRIMMWARE OS Logo" loading="lazy" />
        <img class="tagline" src="images/emotion-is-executable.png" alt="Emotion is Executable" loading="lazy" />
      </div>

      <div class="decrypt-wrapper" role="region" aria-label="Decryption Puzzle">
        <div class="decrypt-boxes">
          <div class="box" id="box0" role="button" tabindex="0" aria-label="Box 1">G</div>
          <div class="box" id="box1" role="button" tabindex="0" aria-label="Box 2">W</div>
          <div class="box" id="box2" role="button" tabindex="0" aria-label="Box 3">O</div>
          <div class="box" id="box3" role="button" tabindex="0" aria-label="Box 4">S</div>
          <div class="separator" aria-hidden="true">_</div>
          <div class="box" id="box4" role="button" tabindex="0" aria-label="Box 5">E</div>
          <div class="box" id="box5" role="button" tabindex="0" aria-label="Box 6">X</div>
          <div class="box" id="box6" role="button" tabindex="0" aria-label="Box 7">E</div>
        </div>
      </div>

      <div class="decrypt-instruction"></div>
    </div>

    <!-- ACCESS MESSAGE -->
    <div id="access-message" class="hidden" aria-live="polite">
      <span class="granted"></span>
      <span class="warning" id="warning-line"></span>
    </div>

    <!-- RUN IT BUTTON -->
    <div class="run-button-wrapper" id="run-wrapper">
      <button id="run-button" aria-label="Execute Gateway Unlock">>>> RUN IT</button>
    </div>
  </div>

  <!-- STRIP WIPE OVERLAY -->
  <div id="gateway-overlay" aria-hidden="true"></div>

  <!-- TERMINAL OVERLAY -->
  <div id="terminal-overlay" class="terminal hidden">
    <div class="terminal-inner" id="terminal-lines">
      <!-- Terminal lines will be injected here by JS -->
    </div>
  </div>

  <!-- DEBUG LOGGER -->
  <div id="debug-log"></div>

  <script>
    function logDebug(message) {
      const logBox = document.getElementById('debug-log');
      const line = document.createElement('div');
      line.textContent = '[LOG] ' + message;
      logBox.appendChild(line);
      logBox.scrollTop = logBox.scrollHeight;
    }

    function validateRunItFlicker() {
      setTimeout(() => {
        const runIt = document.querySelector('.run-it-flicker');
        if (!runIt) {
          logDebug('.run-it-flicker NOT FOUND in DOM.');
        } else {
          const rect = runIt.getBoundingClientRect();
          const styles = window.getComputedStyle(runIt);
          runIt.classList.add('debug-highlight');
          logDebug('.run-it-flicker FOUND.');
          logDebug(`Bounds: ${Math.round(rect.width)}x${Math.round(rect.height)} | Opacity: ${styles.opacity} | Display: ${styles.display}`);
        }
      }, 500);
    }

    // You can call validateRunItFlicker() right after your last terminal line injection
    // Or fire it from wherever you spawn the "Run It" line
  </script>

  <script src="script.js"></script>
</body>
</html>
